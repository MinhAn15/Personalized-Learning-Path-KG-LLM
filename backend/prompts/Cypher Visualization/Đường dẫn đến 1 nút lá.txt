MATCH path = (start:KnowledgeNode {Node_ID: 'concept:data_task'})-[:NEXT|REQUIRES|IS_SUBCONCEPT_OF|IS_PREREQUISITE_OF*2..]->(end:KnowledgeNode)
WHERE NOT ()-[:NEXT|IS_PREREQUISITE_OF|IS_SUBCONCEPT_OF]->(start)
AND NOT (start)-[:REQUIRES]->()
AND NOT (end)-[:NEXT|IS_SUBCONCEPT_OF|IS_PREREQUISITE_OF]->()
AND NOT ()-[:REQUIRES]->(end)
WITH path, length(path) AS path_length, nodes(path) AS nodes
ORDER BY path_length DESC
LIMIT 1
RETURN nodes, last(nodes) AS leaf_node